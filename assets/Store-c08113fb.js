import{r as a,Q as $,a5 as M,a6 as _,w as T,R as m,a7 as N,W as P,b as L,j as S,f as A,M as j,a8 as B,d as D,T as W,g as I}from"./index-73275a35.js";import{M as X}from"./index-a812b97c.js";import{B as q}from"./button-5df35ace.js";import"./LeftOutline-06005382.js";function H(n,i){return n.reduce((o,u)=>Math.abs(o-i)<Math.abs(u-i)?o:u)}const l="adm-swipe-action",Q={rightActions:[],leftActions:[],closeOnTouchOutside:!0,closeOnAction:!0,stopPropagation:[]},z=a.forwardRef((n,i)=>{const o=$(Q,n),u=a.useRef(null),w=a.useRef(null),f=a.useRef(null);function c(t){const e=t.current;return e?e.offsetWidth:0}function v(){return c(w)}function E(){return c(f)}const[{x:g},h]=M(()=>({x:0,config:{tension:200,friction:30}}),[]),p=a.useRef(!1),k=a.useRef(null);function C(){var t;(t=k.current)===null||t===void 0||t.call(k),p.current=!1}const O=_(t=>{var e;if(k.current=t.cancel,!t.intentional||(t.down&&(p.current=!0),!p.current))return;const[r]=t.offset;if(t.last){const x=v(),y=E();let s=r+t.velocity[0]*t.direction[0]*50;r>0?s=Math.max(0,s):r<0?s=Math.min(0,s):s=0;const d=H([-y,0,x],s);h.start({x:d}),d!==0&&((e=n.onActionsReveal)===null||e===void 0||e.call(n,d>0?"left":"right")),window.setTimeout(()=>{p.current=!1})}else h.start({x:r,immediate:!0})},{from:()=>[g.get(),0],bounds:()=>{const t=v();return{left:-E(),right:t}},axis:"x",preventScroll:!0,pointer:{touch:!0},triggerAllEvents:!0});function R(){h.start({x:0}),C()}a.useImperativeHandle(i,()=>({show:(t="right")=>{var e;t==="right"?h.start({x:-E()}):t==="left"&&h.start({x:v()}),(e=n.onActionsReveal)===null||e===void 0||e.call(n,t)},close:R})),a.useEffect(()=>{if(!o.closeOnTouchOutside)return;function t(e){if(g.get()===0)return;const r=u.current;r&&!r.contains(e.target)&&R()}return document.addEventListener("touchstart",t),()=>{document.removeEventListener("touchstart",t)}},[o.closeOnTouchOutside]);function b(t){var e,r;const x=(e=t.color)!==null&&e!==void 0?e:"light";return m.createElement(q,{key:t.key,className:`${l}-action-button`,style:{"--background-color":(r=F[x])!==null&&r!==void 0?r:x},onClick:y=>{var s,d;o.closeOnAction&&R(),(s=t.onClick)===null||s===void 0||s.call(t,y),(d=o.onAction)===null||d===void 0||d.call(o,t,y)}},t.text)}return T(o,m.createElement("div",Object.assign({className:l},O(),{ref:u,onClickCapture:t=>{p.current&&(t.stopPropagation(),t.preventDefault())}}),m.createElement(N.div,{className:`${l}-track`,style:{x:g}},P(o.stopPropagation,m.createElement("div",{className:`${l}-actions ${l}-actions-left`,ref:w},o.leftActions.map(b))),m.createElement("div",{className:`${l}-content`,onClickCapture:t=>{g.goal!==0&&(t.preventDefault(),t.stopPropagation(),R())}},m.createElement(N.div,{style:{pointerEvents:g.to(t=>t!==0&&g.goal!==0?"none":"auto")}},o.children)),P(o.stopPropagation,m.createElement("div",{className:`${l}-actions ${l}-actions-right`,ref:f},o.rightActions.map(b))))))}),F={light:"var(--adm-color-light)",weak:"var(--adm-color-weak)",primary:"var(--adm-color-primary)",success:"var(--adm-color-success)",warning:"var(--adm-color-warning)",danger:"var(--adm-color-danger)"};const G=n=>{const{list:i,queryStoreListAsync:o,removeStoreListById:u}=n;a.useEffect(()=>{i||o()},[]);const w=async f=>{try{const{code:c}=await D.storeRemove(f);if(+c!=0){W.show({icon:"fail",content:"移除失败"});return}W.show({icon:"success",content:"移除成功"}),u(f)}catch{}};return S("div",{className:"store-box",children:[A(X,{title:"我的收藏"}),i?A("div",{className:"list",children:i.map(f=>{let{id:c,news:v}=f;return S(z,{rightActions:[{key:"delete",text:"删除",color:"danger",onClick:w.bind(null,c)}],children:[A(B,{info:v}),";"]},c)})}):A(j,{})]})},Y=L(n=>n.store,I.store)(G);export{Y as default};
